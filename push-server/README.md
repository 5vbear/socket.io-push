###install nodejs

```
sudo apt-get update
curl -sL https://deb.nodesource.com/setup | sudo bash -
sudo apt-get install -y nodejs
#sudo apt-get install -y npm
sudo npm install -g n
sudo n stable
```

###install socket.io

```
npm install socket.io
npm install socket.io-redis
```

###run

node .

###push api

http://183.61.6.33/api/push?pushId=abc&data=aGVsbG93IHdvcmxk&topic=/topic/test&pushAll=true

data -> base64 encoded byte array

topic -> client subscribed topic

pushId -> generated by client

pushAll -> push to all clients subscribing topic

###状态栏通知api

http://183.61.6.33/api/notification?pushId=abc&notification=%7B%20%22android%22%3A%7B%22title%22%3A%22title%22%2C%22message%22%3A%22message%22%7D%2C%22apn%22%3A%7B%22alert%22%3A%22message%22%20%2C%20%22badge%22%3A5%2C%20%22sound%22%3A%22default%22%2C%20%22payload%22%3A1234%7D%7D

pushId -> 客户端生成的随机ID

notification -> 通知消息内容 需要url encode

```
{
  "android" : {"title":"title","message":"message" , "payload" : {"abc":123} },
  "apn":  {"alert":"message" , "badge":5, "sound":"default", "payload":{"abc":123} }
}
```

notification是一个json map,内容说明如下

android - 推送给安卓手机的通知内容

apn - 通过apns推送给ios手机的通知内容

title & message - 安卓通知栏的消息标题和内容

alert(ios) - (apn对应的alert字段)消息内容

badge(ios) - (apn对应的badge字段) 可选

sound(ios) - (apn对应的sound字段) 可选

payload - 发送给应用非显示用的透传信息, 需要是一个json map
