<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Client Demo</title>
    <style>
        * {
            padding: 0px;
            margin: 0px;
        }

        body {
            width: 100%;
            font-family: fantasy;
            font-size: 13px;
        }

        h1 {
            text-align: center;
        }

        #myDiv {
            margin-top: 50px;
            width: 100%;
            text-align: center;
        }

        table {
            margin-left: auto;
            margin-right: auto;
        }

    </style>

    <script src="/js/jquery-1.8.0.min.js"></script>
    <script src="/js/push-client-1.0.js"></script>
</head>
<body>
<script type="text/javascript">
    var pushAll = false;
    function change() {
        var radio = document.getElementsByName("type");
        var radioLength = radio.length;
        for (var i = 0; i < radioLength; i++) {
            if (radio[i].checked) {
                var radioValue = radio[i].value;

                if (radioValue == "yes") {
                    pushAll = true;
                    $("#pushIdDiv").hide();
                    $("#pushUidDiv").hide();
                }
                else if (radioValue == "no") {
                    pushAll = false;
                    $("#pushIdDiv").show();
                    $("#pushUidDiv").show();
                }
            }
        }
    }
    window.onload = function () {
        change();
    }

</script>

<h1>Client Demo</h1>

<form id="myDiv">
    <table cellspacing="10" cellpadding="0" width="400">

        <tr align=left>
            <td width="100" align=right>pushId</td>
            <td width="300" colspan="3"><span id="pushId">not connected</span></td>
        </tr>


        <tr align=left>
            <div>
                <td width="100" align=right>url: &nbsp&nbsp&nbsp</td>
                <td width="300" colspan="3"><input id="urlValue" name="timeToLive"
                                                   value="http://localhost:10001"/><input type="button"
                                                                                          onclick="connect()"
                                                                                          value="connect"/></td>
            </div>
        </tr>

        <tr align=left>
            <div>
                <td width="100" align=right>url: &nbsp&nbsp&nbsp</td>
                <td width="300" colspan="3"><input id="topic" name="topic" value="testTopic"/><input type="button"
                                                                                                     onclick="sub()"
                                                                                                     value="subscribeTopic"/>
                </td>
            </div>
        </tr>

        <tr align=left>
            <td width="100" align=right>data</td>
            <td width="300" colspan="3"><span id="data"/></td>
        </tr>

    </table>
</form>
<br/>
<a id="url"></a>

</div>
<script>

    var pushClient;

    function connect() {
        pushClient = new PushClient($("#urlValue").val(), {useNotification: true});
        console.log('pushId ' + pushClient.pushId);
        $("#pushId").html(pushClient.pushId);
        pushClient.on('push', function (topic, data) {
            $("#data").html($("#data").html() + "<p>topic:" + topic + ",data :" + JSON.stringify(data) + "</p>");
            console.log("on message topic :" + topic + " ,data :" + JSON.stringify(data));
        });
    }

    function sub() {
        subscribeTopic($("#topic").val());
    }

    function subscribeTopic(topic) {
        pushClient.subscribeTopic(topic);
    }

</script>

</body>
</html>